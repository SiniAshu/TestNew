var CommonValidate = { TempMenuList: [], LogOut: function () { return Utility.ServiceCall("POST", "AuthorizationService.svc/InsertUpdateEmployeeLogs", JSON.stringify({ LoginUserID: parseInt(sessionStorage.UserID), StatusID: 3 }), "json", !1, !1, function (e) { e.InsertUpdateEmployeeLogsResult }), sessionStorage.clear(), window.location.href = "../Login.aspx?mode=logout", !1 }, SetOverViewMenu: function () { sessionStorage.setItem("IsmainmenuClicked", !1), sessionStorage.setItem("ActiveMainMenu", 0), $("ul.secondary-nav-ul li").removeClass("active"), $(".secondary-nav-ul-li:eq(0)").addClass("active") }, GetNewMenu: function (e, t) { for (var a = 0; a < e.length; a++) { var n = e[a].replace(/\s+/g, "_"), r = $("<a/>", { href: "#", html: e[a] }), i = ($("<div/>", { "class": "arrow-down" }), $("<li/>", { html: r, "class": "has-menu", id: "li_menu_" + n })); "Admin" == t ? $("#ul_admin_menu_body").append(i) : "Module" == t && $("#ul_menu_body").append(i); var o = $("<ul/>", { "class": "sub-menu", id: "ul_sub_menu_" + n }); $("#li_menu_" + n).append(o); for (var s = 0; s < CommonValidate.TempMenuList.length; s++) if (CommonValidate.TempMenuList[s].ParentMenuName == e[a]) { var l = $("<a/>", { href: CommonValidate.TempMenuList[s].NavigateURL, html: CommonValidate.TempMenuList[s].MenuName, onclick: 'CommonValidate.SubMenuClick("' + CommonValidate.TempMenuList[s].NavigateMenu + '")' }), m = $("<li/>", { html: l }); $("#ul_sub_menu_" + n).append(m), "report" == t ? $("#ul_report_menu_body").append(m) : "Discarded" == t ? $("#anch_discarded_queue").attr("href", CommonValidate.TempMenuList[s].NavigateURL) : "Master_Queue" == t && $("#anch_master_queue").attr("href", CommonValidate.TempMenuList[s].NavigateURL) } } }, SubMenuClick: function (e) { sessionStorage.CurrentMenuselected = e }, GetUserMenu: function () { Utility.ServiceCall("POST", "AuthorizationService.svc/GetUserMenuPermission", JSON.stringify({ UserID: sessionStorage.LoginId, MainMenuID: 0, _commandText: "GET_USER_MENU_RIGHTS" }), "json", !1, !1, function (e) { var t = e.GetUserMenuPermissionResult; if (CommonValidate.TempMenuList = t, t.length > 0) { for (var a = [], n = [], r = [], i = [], o = [], s = 0; s < t.length; s++) t[s].ParentMenuID > 0 && "report" == t[s].NavigateMenu ? r.push(t[s].ParentMenuName) : t[s].ParentMenuID > 0 && "Master_Queue" == t[s].NavigateMenu ? i.push(t[s].ParentMenuName) : t[s].ParentMenuID > 0 && "Discarded" == t[s].NavigateMenu ? o.push(t[s].ParentMenuName) : t[s].ParentMenuID > 0 && "admin" == t[s].NavigateMenu ? n.push(t[s].ParentMenuName) : t[s].ParentMenuID > 0 && "admin" != t[s].NavigateMenu && a.push(t[s].ParentMenuName); var l = Utility.removeDuplicates(a), m = Utility.removeDuplicates(n), u = Utility.removeDuplicates(r); l.length > 0 ? CommonValidate.GetNewMenu(l, "Module") : $("#li_module").hide(), m.length > 0 ? CommonValidate.GetNewMenu(m, "Admin") : $("#li_administrator").hide(), u.length > 0 ? CommonValidate.GetNewMenu(u, "report") : $("#li_reports").hide(), 0 == o.length && $("#li_discarded_queue").hide(), 0 == i.length && $("#li_master_queue").hide(); var d = t[0].RoleID; sessionStorage.setItem("RoleID", d), sessionStorage.setItem("UserName", t[0].FirstName), sessionStorage.setItem("RoleName", t[0].RoleName) } }) } }; $(function () { $("#a_rolemanager").attr("href", "rolemaster.html"), $("#a_usermanager").attr("href", "usermaster.html"), $("#a_distcategmanager").attr("href", "distributorcategorymaster.html"), $("#a_branchmanager").attr("href", "branchmaster.html"), $("#a_passwordpolicy").attr("href", "passwordpolicy.html"), $("#a_exitload").attr("href", "exitloadmaster.html"), $("#a_brokeragenotes").attr("href", "brokeragenotes.html"), $("#a_schemetomodule").attr("href", "SchemeToModuleMaster.html"), $("#a_mailinglist").attr("href", "MailingListMaster.html"), $("#a_userlog").attr("href", "UserLog.html"), $("#a_applicationlock").attr("href", "ApplicationLock.html"), $("#a_audit_trail").attr("href", "AuditTrail.html"), $("#a_login_Admin").attr("href", "LoginAdministration.html"), $("#a_unlock_User").attr("href", "UnlockUsers.html"), CommonValidate.GetUserMenu() });